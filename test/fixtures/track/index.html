<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>track</title>
  <meta name="description" content="test that track creates a cookie with the expected expiry"></meta>
  <script src="/dist/td.js"></script>
</head>
<body>

<script type="text/javascript">
  (function () {
    function setBackground (color) {
      document.body.style.background = color
    }

    function setStatus (text) {
      document.getElementById('status').innerHTML = text
    }

    var td = new Treasure({
      database: 'test_db_request',
      writeKey: '91/96da3cfb876cc50724d0dddef670d95eea2a0018',
      host: 'in.treasuredata.com',
      storage: {
        expires: 5
      }
    })

    if (td.client.storage.expires !== 5) {
      setBackground('red')
      setStatus('failure')
    }

    if (!td.getCookie('_td')) {
      setBackground('red')
      setStatus('failure')
    }
    setTimeout(function () {
      if (td.getCookie('_td')) {
        setBackground('red')
        setStatus('failure')
      } else {
        setBackground('green')
        setStatus('success')
      }
    }, 6000) // 6000ms is longer than 5s
  })()
</script>

<h1 id='status' style="text-align: center;">running</h1>

</body>
</html>
